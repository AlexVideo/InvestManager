# История изменений Invest Manager

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/).

---

## [0.5.0] — 2025-02-15

### Добавлено
- **Версионирование приложения и схемы БД**
  - Единая версия приложения **0.5.0** (отображается в «О программе»).
  - В базе данных хранится версия схемы (`schema_version` в таблице `_meta`). При открытии базы, созданной в старой версии, программа автоматически выполняет миграции и обновляет структуру.
  - Перед миграцией создаётся резервная копия базы (файл с суффиксом `.backup_ГГГГММДД_ЧЧММСС` в той же папке).
- Фильтры по столбцам **Заложено** и **Исполн. %** (всего 7 числовых фильтров).
- Экспорт в Excel только отфильтрованных строк, видимых столбцов в текущем порядке и с текущей сортировкой таблицы.
- Настройка **рудников и участков** перенесена в диалог «Настройки».

### Изменено
- Миграции БД оформлены как нумерованный список (версия схемы 0 → 1 → 2). Добавление столбцов `out_of_budget`, `mine_id`, `section_id` в `projects` — миграция 0→1; столбец `added_by` в таблицах операций — миграция 1→2.

---

## [0.4] — 2025-02

### Добавлено
- Режимы «Инвест» и «Услуги и работы», справочники рудников и участков.
- Формы и карточки договоров услуг, рудник/участок в карточке проекта и в форме добавления.
- Столбцы «Заложено изначально» и «Исполн. %» в таблице проектов, строка состояния (заложено / по договорам исполнено / процент).
- Диалог «Настройки»: видимость и порядок столбцов таблицы, сохранение в QSettings.
- Прикрепляемые файлы в папке **Files** рядом с базой (подпапки: marketing, contract, correction, revision, memos); открытие файла в программе по умолчанию в Windows.
- Учёт «кто внёс изменения» (имя учётной записи Windows) в операциях маркетинга, договоров, корректировок и ревизий.
- Предупреждение и предзаполнение формы при повторном вводе маркетинга или договора; кнопка «Открыть файл» в формах маркетинга и договора.

### Изменено
- Кнопка «?» заменена на «⚙ Настройки».
- Обработка ошибок при открытии файлов и открытии чужой/битой БД.

---

## [0.3] и ранее

- Базовый учёт инвест-проектов, маркетинг, договоры, корректировки, ревизии.
- Экспорт в Excel, импорт проектов, ревизия и служебные записки.

---

[0.5.0]: https://github.com/your-repo/compare/v0.4...v0.5.0
[0.4]: https://github.com/your-repo/compare/v0.3...v0.4
